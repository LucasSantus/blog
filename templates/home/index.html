{% extends 'base.html' %}

{% load static %}

{% block title %}
    Dashboard | BLOG
{% endblock %}

{% block content %}
    <div class="mt-3 p-4 p-md-5 mb-4 text-white rounded bg-dark">
        <div class="col-md-6 px-0">
            <h1 class="display-4 fst-italic">Title of a longer featured blog post</h1>
            <p class="lead my-3">Multiple lines of text that form the lede, informing new readers quickly and efficiently about what’s most interesting in this post’s contents.</p>
            <p class="lead mb-0"><a href="#postagens" class="text-white fw-bold">Veja Mais...</a></p>
        </div>
    </div>
    
    <div class="row mb-2">
        {% for new_post in new_posts %}
            <div class="col-md-6">
                <div class="row g-0 border rounded overflow-hidden flex-md-row mb-4 shadow-sm h-md-250 position-relative">
                    <div class="col p-4 d-flex flex-column position-static">
                        <strong class="d-inline-block mb-2 text-success">{{new_post.category.title}}
                            <span class="badge rounded-pill bg-success">new</span>
                        </strong>

                        <h3 class="mb-0">{{new_post.title}}</h3>

                        <div class="mb-1 text-muted">
                            {{new_post.time_registered.date|date:"d M, Y"}}
                        </div>

                        <p class="card-text mb-auto">{{new_post.resume}}</p>

                        <a href="#" class="h6 mt-2">Leia Mais</a>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

    <div id="postagens" class="row g-5">
        <div class="col-md-8">
            <div class="p-3">
                <div class="row">
                    <div class="col-12 col-sm-11">
                        <h3 class="fst-italic">
                            Postagens
                        </h3>
                    </div>
                    
                    <!-- {% if user.is_authenticated %}
                        <div class="col-12 col-sm-1 d-flex justify-content-center">
                            <a href="{% url 'register_post' %}" class="btn-rounded-icon text-decoration-none">
                                <span class="material-icons border border-2 border-primary rounded-circle">add</span>
                            </a>
                        </div>
                    {% endif %} -->
                </div>
            </div>

            {% if page_posts %}
                {% for post in page_posts %}
                    <article class="blog-post">
                        <h2 class="blog-post-title">{{post.title}}</h2>
                        <p class="blog-post-meta">{{post.time_registered|date:"d M, Y"}} by <a href="#">{{post.author.get_short_name}}</a></p>
                        <p>{{post.description}}</p>
                    </article>
                {% endfor %}

                <nav class="blog-pagination d-flex justify-content-end" aria-label="Pagination">
                    <span class="d-flex align-items-center m-1">
                        Página {{ page_posts.number }} de {{ page_posts.paginator.num_pages }}
                    </span>
    
                    {% if page_posts.has_previous %}
                        <a class="btn btn-outline-primary m-1" href="?page={{ page_posts.previous_page_number }}">Anterior</a>
                    {% else %}
                        <a class="btn btn-outline-secondary m-1 disabled">Anterior</a>
                    {% endif %}
    
                    {% if page_posts.has_next %}
                        <a class="btn btn-outline-primary m-1" href="?page={{ page_posts.next_page_number }}">Próxima</a>
                    {% else %}
                        <a class="btn btn-outline-secondary m-1 disabled">Próxima</a>
                    {% endif %}
                </nav>
            {% else %}
                <div class="mt-5 text-center">
                    <span class="text-muted">
                        Atualmente não há postagens disponiveis!
                    </span>
                </div>
            {% endif %}
        </div>

        <div class="col-md-4">
            <div class="position-sticky" style="top: 2rem;">
                {% if not user.is_authenticated %}
                    <div class="p-4 mb-3 bg-light rounded">
                        <h4 class="fst-italic">About</h4>
                        <p class="mb-0">Customize this section to tell your visitors a little bit about your publication, writers, content, or something else entirely. Totally up to you.</p>
                    </div>
                {% endif %}

                <div class="p-3">
                    <div class="row">
                        <div class="col-12 col-sm-11 mb-3">
                            <h4 class="fst-italic">Categorias</h4>
                        </div>
                        {% if user.is_authenticated %}
                            <div class="col-12 col-sm-1 d-flex justify-content-center">
                                <a href="{% url 'register_category' %}" class="btn-rounded-icon text-decoration-none">
                                    <span class="material-icons border border-2 border-primary rounded-circle">add</span>
                                </a>
                            </div>
                        {% endif %}
                    </div>
                    
                    <ol class="list-unstyled mb-0">
                        {% if categorys %}
                            {% for category in categorys %}
                            <li>
                                <div class="row">
                                    <div class="col-10">
                                        <a class="text-decoration-none opacity-hover" href="{% url 'view_posts_categorys' category.slug %}">{{category.title}}</a>
                                    </div>
                                    <div class="col-2">
                                        <div class="row">
                                            <div class="col-6">
                                                <a href="#">
                                                    <span class="material-icons text-success opacity-hover" style="font-size: 20px;">edit</span>
                                                </a>
                                            </div>
                                            <div class="col-6">
                                                <a href="#">
                                                    <span class="material-icons text-danger opacity-hover" style="font-size: 20px;">delete</span>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </li>
                            {% endfor %}
                        {% endif %}
                    </ol>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

